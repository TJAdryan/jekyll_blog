<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="If You Have To Use Excel, Automate It: Formatting with Python" />
<meta property="og:locale" content="en" />
<meta name="description" content="Automate Excel Formatting with Python, Pandas, &amp; XlsxWriter" />
<meta property="og:description" content="Automate Excel Formatting with Python, Pandas, &amp; XlsxWriter" />
<link rel="canonical" href="https://nextvaldata.com/development/data/2024/07/18/If-you-have-to.html" />
<meta property="og:url" content="https://nextvaldata.com/development/data/2024/07/18/If-you-have-to.html" />
<meta property="og:site_name" content="NextValData" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-07-18T12:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="If You Have To Use Excel, Automate It: Formatting with Python" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-07-18T12:00:00-04:00","datePublished":"2024-07-18T12:00:00-04:00","description":"Automate Excel Formatting with Python, Pandas, &amp; XlsxWriter","headline":"If You Have To Use Excel, Automate It: Formatting with Python","mainEntityOfPage":{"@type":"WebPage","@id":"https://nextvaldata.com/development/data/2024/07/18/If-you-have-to.html"},"url":"https://nextvaldata.com/development/data/2024/07/18/If-you-have-to.html"}</script>
<!-- End Jekyll SEO tag -->


  <title>If You Have To Use Excel, Automate It: Formatting with Python | NextValData
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="NextValData">
<meta name="application-name" content="NextValData">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/favicon.ico" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">NextValData</a>
    <p class="site-subtitle fst-italic mb-0">Sequential sense is better than nonsense</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/tjadryan"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['dominick','nextvaldata.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
        
          
        
          
        
          
        
          
            
              <span>If You Have To Use Excel, Automate It: Formatting with Python</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>If You Have To Use Excel, Automate It: Formatting with Python</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1721318400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jul 18, 2024
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/tjadryan">Dominick Ryan</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1288 words"
>
  <em>7 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">If You Have To Use Excel, Automate It: Formatting with Python</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">If You Have To Use Excel, Automate It: Formatting with Python</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h1 id="automate-excel-formatting-with-python-pandas--xlsxwriter">Automate Excel Formatting with Python, Pandas, &amp; XlsxWriter</h1>

<p>Sometimes people need to download some data, format it in Excel, and distribute it. And they have to do this every day, and you look at it and think “I bet I could automate that.” And you are right!  You could automate it and make someone’s life a lot easier. Don’t be a slacker, help them out.</p>

<h2 id="how-it-works"><span class="me-2">How it Works</span><a href="#how-it-works" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>After writing a Pandas DataFrame to an Excel sheet using <code class="language-plaintext highlighter-rouge">df.to_excel(writer, ...)</code>, you can access XlsxWriter’s workbook and worksheet objects. The library has a ton of formatting options I am not even touching here. If you want to review them all, check out the <a href="https://xlsxwriter.readthedocs.io/">XlsxWriter documentation</a>.</p>

<p>Let’s walk through a Python script that uses Pandas and XlsxWriter to create a well-formatted Excel report from a DataFrame (df1).</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="c1"># Assume df1 is a pre-existing Pandas DataFrame
# For example:
# data = {'ColA': [1, 2, 3], 'ColB': ['X', 'Y', 'Z'], 'ColC': [10.1, 20.2, 30.3], 'ColD': [True, False, True]}
# df1 = pd.DataFrame(data)
</span>
<span class="c1"># 1. Initialize ExcelWriter with XlsxWriter engine
</span><span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">ExcelWriter</span><span class="p">(</span><span class="sh">'</span><span class="s">formatted_report.xlsx</span><span class="sh">'</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="sh">'</span><span class="s">xlsxwriter</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 2. Write DataFrame to a sheet
# index=False prevents writing the DataFrame index as a column in Excel
</span><span class="n">df1</span><span class="p">.</span><span class="nf">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="sh">'</span><span class="s">Sheet1</span><span class="sh">'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># 3. Access XlsxWriter workbook and worksheet objects
</span><span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="p">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="p">.</span><span class="n">sheets</span><span class="p">[</span><span class="sh">'</span><span class="s">Sheet1</span><span class="sh">'</span><span class="p">]</span>

<span class="c1"># 4. Format the Header Row
# Define a format for the header cells
</span><span class="n">header_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="nf">add_format</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">bold</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">italic</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">underline</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">font_size</span><span class="sh">'</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">bottom</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>    <span class="c1"># Medium border
</span>    <span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>       <span class="c1"># Medium border
</span>    <span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>      <span class="c1"># Medium border
</span>    <span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>     <span class="c1"># Medium border
</span>    <span class="sh">'</span><span class="s">align</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">center</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">valign</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">vcenter</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">bg_color</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">#DDEBF7</span><span class="sh">'</span> <span class="c1"># A light blue background
</span><span class="p">})</span>
<span class="c1"># Apply the format to the header row (rewriting what Pandas initially wrote)
</span><span class="k">for</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">df1</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>

<span class="c1"># 5. Define Formats for Data Cells
# General format for data cells (thin borders on all sides)
</span><span class="n">format1_all_borders</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="nf">add_format</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">bottom</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">})</span>

<span class="c1"># Specific format for the first row of data (medium top border, thin other borders)
</span><span class="n">format2_first_data_row</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="nf">add_format</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>    <span class="c1"># Medium top border
</span>    <span class="sh">'</span><span class="s">bottom</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1"># Thin bottom border
</span>    <span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Thin right border
</span>    <span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span>    <span class="c1"># Thin left border
</span><span class="p">})</span>

<span class="c1"># 6. Apply Conditional Formatting to Data Cells
# This applies 'format2_first_data_row' to the first row of data (row index 1)
# It checks if cells are not blank (criteria: '&gt;=', value: '""' effectively means not blank for text/numbers)
</span><span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># Ensure there is at least one data row
</span>    <span class="n">worksheet</span><span class="p">.</span><span class="nf">conditional_format</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">cell</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">criteria</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">&gt;=</span><span class="sh">'</span><span class="p">,</span> <span class="c1"># Applies to cells with any content (numbers or text)
</span>        <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'""'</span><span class="p">,</span>    <span class="c1"># Compares against an empty string
</span>        <span class="sh">'</span><span class="s">format</span><span class="sh">'</span><span class="p">:</span> <span class="n">format2_first_data_row</span>
    <span class="p">})</span>

    <span class="c1"># Apply 'format1_all_borders' to all data cells
</span>    <span class="n">worksheet</span><span class="p">.</span><span class="nf">conditional_format</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">cell</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">criteria</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">&gt;=</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'""'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">format</span><span class="sh">'</span><span class="p">:</span> <span class="n">format1_all_borders</span>
    <span class="p">})</span>

<span class="c1"># 7. Add an Excel Table with AutoFilter and Style
</span><span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">column_settings</span> <span class="o">=</span> <span class="p">[{</span><span class="sh">'</span><span class="s">header</span><span class="sh">'</span><span class="p">:</span> <span class="n">column</span><span class="p">}</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df1</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">worksheet</span><span class="p">.</span><span class="nf">add_table</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">columns</span><span class="sh">'</span><span class="p">:</span> <span class="n">column_settings</span><span class="p">,</span> <span class="c1"># Use DataFrame headers for the table
</span>        <span class="sh">'</span><span class="s">autofilter</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">style</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Table Style Light 1</span><span class="sh">'</span>
    <span class="p">})</span>
<span class="k">else</span><span class="p">:</span> <span class="c1"># Handle empty DataFrame: create table with only headers
</span>    <span class="n">column_settings</span> <span class="o">=</span> <span class="p">[{</span><span class="sh">'</span><span class="s">header</span><span class="sh">'</span><span class="p">:</span> <span class="n">column</span><span class="p">}</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df1</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">worksheet</span><span class="p">.</span><span class="nf">add_table</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">columns</span><span class="sh">'</span><span class="p">:</span> <span class="n">column_settings</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">autofilter</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">style</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Table Style Light 1</span><span class="sh">'</span>
    <span class="p">})</span>

<span class="c1"># 8. Set Column Widths
# Adjust these character widths based on your data
</span><span class="n">worksheet</span><span class="p">.</span><span class="nf">set_column</span><span class="p">(</span><span class="sh">'</span><span class="s">A:A</span><span class="sh">'</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="nf">set_column</span><span class="p">(</span><span class="sh">'</span><span class="s">B:B</span><span class="sh">'</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="nf">set_column</span><span class="p">(</span><span class="sh">'</span><span class="s">C:D</span><span class="sh">'</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="nf">set_column</span><span class="p">(</span><span class="sh">'</span><span class="s">E:K</span><span class="sh">'</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">)</span> <span class="c1"># Example range
</span>
<span class="c1"># 9. Page Setup for Printing
</span><span class="n">worksheet</span><span class="p">.</span><span class="nf">set_landscape</span><span class="p">()</span>      <span class="c1"># Set page orientation to landscape
</span><span class="n">worksheet</span><span class="p">.</span><span class="nf">repeat_rows</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>       <span class="c1"># Repeat header row (row 0) on each printed page
</span>
<span class="c1"># 10. Save and Close the Excel File
</span><span class="k">try</span><span class="p">:</span>
    <span class="n">writer</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># This also saves the file
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Excel file </span><span class="sh">'</span><span class="s">formatted_report.xlsx</span><span class="sh">'</span><span class="s"> saved successfully!</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error saving Excel file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="explanation-of-the-code"><span class="me-2">Explanation of the Code</span><a href="#explanation-of-the-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ol>
  <li>
    <p><strong>Initialize ExcelWriter with XlsxWriter engine</strong></p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">ExcelWriter</span><span class="p">(</span><span class="sh">'</span><span class="s">formatted_report.xlsx</span><span class="sh">'</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="sh">'</span><span class="s">xlsxwriter</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Write DataFrame to a sheet</strong></p>

    <p><code class="language-plaintext highlighter-rouge">index=False</code> prevents writing the DataFrame index as a column in Excel.</p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">df1</span><span class="p">.</span><span class="nf">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="sh">'</span><span class="s">Sheet1</span><span class="sh">'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Access XlsxWriter workbook and worksheet objects</strong></p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="p">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="p">.</span><span class="n">sheets</span><span class="p">[</span><span class="sh">'</span><span class="s">Sheet1</span><span class="sh">'</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Format the Header Row</strong></p>

    <p>Define a format for the header cells.</p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="n">header_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="nf">add_format</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">bold</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">italic</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">underline</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">font_size</span><span class="sh">'</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">bottom</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>    <span class="c1"># Medium border
</span>    <span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>       <span class="c1"># Medium border
</span>    <span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>      <span class="c1"># Medium border
</span>    <span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>     <span class="c1"># Medium border
</span>    <span class="sh">'</span><span class="s">align</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">center</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">valign</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">vcenter</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">bg_color</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">#DDEBF7</span><span class="sh">'</span> <span class="c1"># A light blue background
</span><span class="p">})</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <p>Apply the format to the header row (rewriting what Pandas initially wrote).</p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="k">for</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">df1</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Define Formats for Data Cells</strong></p>

    <p>General format for data cells (thin borders on all sides).</p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">format1_all_borders</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="nf">add_format</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">bottom</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">})</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <p>Specific format for the first row of data (medium top border, thin other borders).</p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">format2_first_data_row</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">.</span><span class="nf">add_format</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">top</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>    <span class="c1"># Medium top border
</span>    <span class="sh">'</span><span class="s">bottom</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1"># Thin bottom border
</span>    <span class="sh">'</span><span class="s">right</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Thin right border
</span>    <span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span>    <span class="c1"># Thin left border
</span><span class="p">})</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Apply Conditional Formatting to Data Cells</strong></p>

    <p>This applies ‘format2_first_data_row’ to the first row of data (row index 1). It checks if cells are not blank (criteria: ‘&gt;=’, value: ‘””’ effectively means not blank for text/numbers).</p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># Ensure there is at least one data row
</span>    <span class="n">worksheet</span><span class="p">.</span><span class="nf">conditional_format</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">cell</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">criteria</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">&gt;=</span><span class="sh">'</span><span class="p">,</span> <span class="c1"># Applies to cells with any content (numbers or text)
</span>        <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'""'</span><span class="p">,</span>    <span class="c1"># Compares against an empty string
</span>        <span class="sh">'</span><span class="s">format</span><span class="sh">'</span><span class="p">:</span> <span class="n">format2_first_data_row</span>
    <span class="p">})</span>

    <span class="c1"># Apply 'format1_all_borders' to all data cells
</span>    <span class="n">worksheet</span><span class="p">.</span><span class="nf">conditional_format</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">cell</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">criteria</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">&gt;=</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'""'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">format</span><span class="sh">'</span><span class="p">:</span> <span class="n">format1_all_borders</span>
    <span class="p">})</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Add an Excel Table with AutoFilter and Style</strong></p>

    <p>The table range should include the header row (row 0) and all data rows. <code class="language-plaintext highlighter-rouge">df1.shape[0]</code> is the number of data rows, so the last data row index is <code class="language-plaintext highlighter-rouge">df1.shape[0]</code>.</p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">column_settings</span> <span class="o">=</span> <span class="p">[{</span><span class="sh">'</span><span class="s">header</span><span class="sh">'</span><span class="p">:</span> <span class="n">column</span><span class="p">}</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df1</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">worksheet</span><span class="p">.</span><span class="nf">add_table</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">columns</span><span class="sh">'</span><span class="p">:</span> <span class="n">column_settings</span><span class="p">,</span> <span class="c1"># Use DataFrame headers for the table
</span>        <span class="sh">'</span><span class="s">autofilter</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">style</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Table Style Light 1</span><span class="sh">'</span>
    <span class="p">})</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <p>Handle empty DataFrame: create table with only headers.</p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="k">else</span><span class="p">:</span> <span class="c1"># Handle empty DataFrame: create table with only headers
</span>    <span class="n">column_settings</span> <span class="o">=</span> <span class="p">[{</span><span class="sh">'</span><span class="s">header</span><span class="sh">'</span><span class="p">:</span> <span class="n">column</span><span class="p">}</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df1</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">worksheet</span><span class="p">.</span><span class="nf">add_table</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">df1</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">columns</span><span class="sh">'</span><span class="p">:</span> <span class="n">column_settings</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">autofilter</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">style</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Table Style Light 1</span><span class="sh">'</span>
    <span class="p">})</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Set Column Widths</strong></p>

    <p>Adjust these character widths based on your data.</p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">worksheet</span><span class="p">.</span><span class="nf">set_column</span><span class="p">(</span><span class="sh">'</span><span class="s">A:A</span><span class="sh">'</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="nf">set_column</span><span class="p">(</span><span class="sh">'</span><span class="s">B:B</span><span class="sh">'</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="nf">set_column</span><span class="p">(</span><span class="sh">'</span><span class="s">C:D</span><span class="sh">'</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="nf">set_column</span><span class="p">(</span><span class="sh">'</span><span class="s">E:K</span><span class="sh">'</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">)</span> <span class="c1"># Example range
</span></pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Page Setup for Printing</strong></p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">worksheet</span><span class="p">.</span><span class="nf">set_landscape</span><span class="p">()</span>      <span class="c1"># Set page orientation to landscape
</span><span class="n">worksheet</span><span class="p">.</span><span class="nf">repeat_rows</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>       <span class="c1"># Repeat header row (row 0) on each printed page
</span></pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Save and Close the Excel File</strong></p>

    <div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">try</span><span class="p">:</span>
    <span class="n">writer</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># This also saves the file
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Excel file </span><span class="sh">'</span><span class="s">formatted_report.xlsx</span><span class="sh">'</span><span class="s"> saved successfully!</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error saving Excel file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
</ol>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/development/">Development</a>,
          <a href="/categories/data/">Data</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/python/"
            class="post-tag no-text-decoration"
          >python</a>
        
          <a
            href="/tags/excel/"
            class="post-tag no-text-decoration"
          >excel</a>
        
          <a
            href="/tags/pandas/"
            class="post-tag no-text-decoration"
          >pandas</a>
        
          <a
            href="/tags/xlsxwriter/"
            class="post-tag no-text-decoration"
          >xlsxwriter</a>
        
          <a
            href="/tags/automation/"
            class="post-tag no-text-decoration"
          >automation</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=If%20You%20Have%20To%20Use%20Excel,%20Automate%20It:%20Formatting%20with%20Python%20-%20NextValData&u=https%3A%2F%2Fnextvaldata.com%2Fdevelopment%2Fdata%2F2024%2F07%2F18%2FIf-you-have-to.html" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fnextvaldata.com%2Fdevelopment%2Fdata%2F2024%2F07%2F18%2FIf-you-have-to.html&text=If%20You%20Have%20To%20Use%20Excel,%20Automate%20It:%20Formatting%20with%20Python%20-%20NextValData" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/data%20engineering/python/orchestration/2025/06/29/Better-Pipelines-with-Dagster.html">Building Data Pipelines with Dagster: Practical</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/data%20engineering/python/api/2025/06/14/Bring-me-the-Data.html">Bring me the Data</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/data%20engineering/python/2025/06/08/DuckDB-Diners-Drives-and-Databases-PartII.html">DuckDB - Diners, Drives, and Databases Part II</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/data%20engineering/python/2025/06/06/DuckDB-Diners-Drives-and-Databases.html">DuckDB - Diners, Drives, and Databases Part I</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/data%20engineering/python/2025/06/01/Next-Train-To-Alberquerque.html">Next Train to Alberquerque: Track NYC Subway Arrivals in Real-Time with Python</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/data-analysis/">data analysis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pandas/">Pandas</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/testing/">testing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/duckdb/">DuckDB</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/excel/">excel</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/admin/">admin</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/development/automation/databases/2025/05/26/Automated-SQL-Backups-to-Google-Drive.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1748275200"
  data-df="ll"
  
>
  May 26, 2025
</time>

              <h4 class="pt-0 my-2">Automated SQL Backups to Google Drive with Python</h4>
              <div class="text-muted">
                <p>Protecting your data is crucial, and having automated backups is a cornerstone of any robust data strategy. In this post, I’ll walk you through a Python script that automatically backs up your SQL ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/development/automation/2024/09/12/Sometimes-Selenium.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1726156800"
  data-df="ll"
  
>
  Sep 12, 2024
</time>

              <h4 class="pt-0 my-2">Sometimes Selenium Works Best: Web Automation in Python</h4>
              <div class="text-muted">
                <p>Quick Intro: Web Automation with Selenium It took me a while before I was able to interact with the pop-up on the website I was trying to scrape. I know people swear by Playwright, but I feel like ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/technology/data/2024/06/05/xml-all-the-things.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1717603200"
  data-df="ll"
  
>
  Jun  5, 2024
</time>

              <h4 class="pt-0 my-2">XLSX are Just Text Files in a Trench Coat</h4>
              <div class="text-muted">
                <p>It’s XML All the Way Down  A few years ago I was tasked to use an API with poor documentation that was only available in SOAP. Fortunately, there is a Python library called Zeep (docs.python-zeep.o...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/development/administration/2024/07/10/All-the-Teams-Storage.html"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Identifying Microsoft Teams Storage Usage with Python and Graph API</p>
    </a>
  

  
    <a
      href="/development/automation/2024/09/12/Sometimes-Selenium.html"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Sometimes Selenium Works Best: Web Automation in Python</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/tjadryan">Dominick Ryan</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.0"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/data-analysis/">data analysis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pandas/">Pandas</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/testing/">testing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/duckdb/">DuckDB</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/excel/">excel</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/admin/">admin</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

