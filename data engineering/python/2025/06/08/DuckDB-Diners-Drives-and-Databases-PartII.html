<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="DuckDB - Diners, Drives, and Databases Part II" />
<meta property="og:locale" content="en" />
<meta name="description" content="This is the place where I try to document and improve my understanding of the things I am working on. I am putting a lot of emphasis on try here." />
<meta property="og:description" content="This is the place where I try to document and improve my understanding of the things I am working on. I am putting a lot of emphasis on try here." />
<link rel="canonical" href="https://nextvaldata.com/data%20engineering/python/2025/06/08/DuckDB-Diners-Drives-and-Databases-PartII.html" />
<meta property="og:url" content="https://nextvaldata.com/data%20engineering/python/2025/06/08/DuckDB-Diners-Drives-and-Databases-PartII.html" />
<meta property="og:site_name" content="NextValData" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-06-08T00:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="DuckDB - Diners, Drives, and Databases Part II" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-08T00:00:00-04:00","datePublished":"2025-06-08T00:00:00-04:00","description":"This is the place where I try to document and improve my understanding of the things I am working on. I am putting a lot of emphasis on try here.","headline":"DuckDB - Diners, Drives, and Databases Part II","mainEntityOfPage":{"@type":"WebPage","@id":"https://nextvaldata.com/data%20engineering/python/2025/06/08/DuckDB-Diners-Drives-and-Databases-PartII.html"},"url":"https://nextvaldata.com/data%20engineering/python/2025/06/08/DuckDB-Diners-Drives-and-Databases-PartII.html"}</script>
<!-- End Jekyll SEO tag -->


  <title>DuckDB - Diners, Drives, and Databases Part II | NextValData
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="NextValData">
<meta name="application-name" content="NextValData">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/favicon.ico" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">NextValData</a>
    <p class="site-subtitle fst-italic mb-0">Sequential sense is better than nonsense</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/tjadryan"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['dominick','nextvaldata.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
        
          
        
          
        
          
        
          
            
              <span>DuckDB - Diners, Drives, and Databases Part II</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>DuckDB - Diners, Drives, and Databases Part II</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1749355200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jun  8, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/tjadryan">Dominick Ryan</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1743 words"
>
  <em>9 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">DuckDB - Diners, Drives, and Databases Part II</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">DuckDB - Diners, Drives, and Databases Part II</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <p><a href="/assets/img/duckdbgf2.png" class="popup img-link shimmer"><img src="/assets/img/duckdbgf2.png" alt="All paws on Deck" width="400px" height="auto" loading="lazy"></a></p>

<p style="font-size:0.9em; margin-top:0.5em; color:#555;"><em>Hoping for an A.</em></p>

<p>In <a href="/data%20engineering/python/2025/06/06/DuckDB-Diners-Drives-and-Databases.html">Part I</a> , we got our feet wet by performing initial data explorations on the NYC restaurant inspection dataset directly from a CSV file. We saw how DuckDB allows for quick insights without full data loading into memory.</p>

<p>I felt like I didn’t get to cover everything I wanted to touch in the last post so here I will focus on some of the other capabilities namely as a lightweight, in-process ETL (Extract, Transform, Load) tool.</p>

<p>We’ll cover:</p>

<ul>
  <li>Performing CSV-to-CSV transformations purely with SQL, without ever needing to manually inspect the file.</li>
  <li>Converting your transformed data into space-efficient formats like compressed CSV (GZIP) and Parquet, and quantifying the storage savings.</li>
  <li>Inspecting the data types within DuckDB and confirming their compatibility before a potential load into a production database like PostgreSQL.</li>
</ul>

<p>Let’s pick up where we left off, assuming you have your DOHMH.csv file ready and your DuckDB environment set up.</p>

<h2 id="1-the-blind-csv-to-csv-transformation"><span class="me-2">1. The “Blind” CSV-to-CSV Transformation</span><a href="#1-the-blind-csv-to-csv-transformation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Imagine you’ve received a large CSV file, and you know it needs some basic cleaning or column selection before you can use it. Just to save a subset. DuckDB is perfect for this “blind” transformation.</p>

<p>We’ll take our DOHMH.csv and perform a few common transformations:</p>

<ul>
  <li>Select a subset of relevant columns.</li>
  <li>Rename a column (<code class="language-plaintext highlighter-rouge">DBA</code> to <code class="language-plaintext highlighter-rouge">Restaurant_Name</code> for clarity).</li>
  <li>Filter out any records where the <code class="language-plaintext highlighter-rouge">BORO</code> is <code class="language-plaintext highlighter-rouge">'0'</code> (an anomalous entry we noticed in Part I).</li>
  <li>Write the transformed data to a new CSV file.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">duckdb</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>  <span class="c1"># For displaying schemas later
</span>
<span class="c1"># Define the path to your original CSV file
</span><span class="n">csv_file_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">DOHMH.csv</span><span class="sh">'</span>
<span class="c1"># Define the path for the new, transformed CSV
</span><span class="n">transformed_csv_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">DOHMH_transformed.csv</span><span class="sh">'</span>

<span class="c1"># Establish a connection to an in-memory DuckDB database
</span><span class="n">con</span> <span class="o">=</span> <span class="n">duckdb</span><span class="p">.</span><span class="nf">connect</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">--- Performing CSV-to-CSV Transformation ---</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Reading </span><span class="sh">'</span><span class="si">{</span><span class="n">csv_file_path</span><span class="si">}</span><span class="sh">'</span><span class="s"> and writing to </span><span class="sh">'</span><span class="si">{</span><span class="n">transformed_csv_path</span><span class="si">}</span><span class="sh">'</span><span class="s">...</span><span class="sh">"</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Use DuckDB's COPY statement with a subquery to transform data
</span>    <span class="c1"># The subquery selects, renames, and filters data without loading the whole file
</span>    <span class="n">transform_query</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">'''</span><span class="s">
    COPY (
        SELECT
            </span><span class="sh">"</span><span class="s">CAMIS</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">DBA</span><span class="sh">"</span><span class="s"> AS </span><span class="sh">"</span><span class="s">Restaurant_Name</span><span class="sh">"</span><span class="s">, -- Renaming DBA column
            </span><span class="sh">"</span><span class="s">BORO</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">BUILDING</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">STREET</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">ZIPCODE</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">CUISINE DESCRIPTION</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">INSPECTION DATE</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">ACTION</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">VIOLATION CODE</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">VIOLATION DESCRIPTION</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">CRITICAL FLAG</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">SCORE</span><span class="sh">"</span><span class="s">,
            </span><span class="sh">"</span><span class="s">GRADE</span><span class="sh">"</span><span class="s">
        FROM
            </span><span class="sh">'</span><span class="si">{</span><span class="n">csv_file_path</span><span class="si">}</span><span class="sh">'</span><span class="s">
        WHERE
            </span><span class="sh">"</span><span class="s">BORO</span><span class="sh">"</span><span class="s"> != </span><span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="s"> -- Filter out anomalous </span><span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="s"> borough
            AND </span><span class="sh">"</span><span class="s">CAMIS</span><span class="sh">"</span><span class="s"> IS NOT NULL -- Ensure unique identifier is present
    ) TO </span><span class="sh">'</span><span class="si">{</span><span class="n">transformed_csv_path</span><span class="si">}</span><span class="sh">'</span><span class="s"> (HEADER, DELIMITER </span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="s">);
    </span><span class="sh">'''</span>
    <span class="n">con</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">transform_query</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Transformation complete. Transformed data saved to: </span><span class="si">{</span><span class="n">transformed_csv_path</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error during transformation: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">finally</span><span class="p">:</span>
    <span class="n">con</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>
<h2 id="2-space-saving-formats-compressed-csv--parquet"><span class="me-2">2. Space-Saving Formats: Compressed CSV &amp; Parquet</span><a href="#2-space-saving-formats-compressed-csv--parquet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Once your data is transformed, you often want to store it efficiently. DuckDB makes it trivial to convert your data into compressed formats, which can significantly reduce storage space and often improve read performance for subsequent analytical queries. We’ll compare:</p>

<p>The original DOHMH.csv.
Our new DOHMH_transformed.csv.
A GZIP-compressed version of the transformed CSV.
A Parquet version of the transformed data.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre></td><td class="rouge-code"><pre>
<span class="kn">import</span> <span class="n">duckdb</span>
<span class="kn">import</span> <span class="n">os</span>

<span class="c1"># Paths from previous step
</span><span class="n">original_csv_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">DOHMH.csv</span><span class="sh">'</span>
<span class="n">transformed_csv_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">DOHMH_transformed.csv</span><span class="sh">'</span>
<span class="n">compressed_csv_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">DOHMH_transformed_compressed.csv.gz</span><span class="sh">'</span> <span class="c1"># .gz suffix is common for GZIP
</span><span class="n">parquet_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">DOHMH_transformed.parquet</span><span class="sh">'</span>

<span class="c1"># Ensure the transformed_csv_path exists from the previous step, or run the transformation again
# Re-establishing connection for this snippet
</span><span class="n">con</span> <span class="o">=</span> <span class="n">duckdb</span><span class="p">.</span><span class="nf">connect</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">--- Comparing File Sizes ---</span><span class="sh">"</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Get original CSV size
</span>    <span class="n">original_size_bytes</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">getsize</span><span class="p">(</span><span class="n">original_csv_path</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Original CSV Size: </span><span class="si">{</span><span class="n">original_size_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> MB</span><span class="sh">"</span><span class="p">)</span>

    <span class="c1"># Get transformed CSV size
</span>    <span class="n">transformed_size_bytes</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">getsize</span><span class="p">(</span><span class="n">transformed_csv_path</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Transformed CSV Size: </span><span class="si">{</span><span class="n">transformed_size_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> MB</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  Savings from Transformation (selected columns, filtered rows): </span><span class="sh">"</span>
          <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="p">((</span><span class="n">original_size_bytes</span> <span class="o">-</span> <span class="n">transformed_size_bytes</span><span class="p">)</span> <span class="o">/</span> <span class="n">original_size_bytes</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>

    <span class="c1"># Write to GZIP compressed CSV
</span>    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Writing transformed data to GZIP compressed CSV: </span><span class="si">{</span><span class="n">compressed_csv_path</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">copy_to_compressed_csv_query</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"""</span><span class="s">
    COPY (SELECT * FROM </span><span class="sh">'</span><span class="si">{</span><span class="n">transformed_csv_path</span><span class="si">}</span><span class="sh">'</span><span class="s">) TO </span><span class="sh">'</span><span class="si">{</span><span class="n">compressed_csv_path</span><span class="si">}</span><span class="sh">'</span><span class="s"> (HEADER, DELIMITER </span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="s">, COMPRESSION GZIP);
    </span><span class="sh">"""</span>
    <span class="n">con</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">copy_to_compressed_csv_query</span><span class="p">)</span>
    <span class="n">compressed_size_bytes</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">getsize</span><span class="p">(</span><span class="n">compressed_csv_path</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Compressed CSV (GZIP) Size: </span><span class="si">{</span><span class="n">compressed_size_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> MB</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  Savings vs. Transformed CSV: </span><span class="sh">"</span>
          <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="p">((</span><span class="n">transformed_size_bytes</span> <span class="o">-</span> <span class="n">compressed_size_bytes</span><span class="p">)</span> <span class="o">/</span> <span class="n">transformed_size_bytes</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>


    <span class="c1"># Write to Parquet
</span>    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Writing transformed data to Parquet: </span><span class="si">{</span><span class="n">parquet_path</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">copy_to_parquet_query</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"""</span><span class="s">
    COPY (SELECT * FROM </span><span class="sh">'</span><span class="si">{</span><span class="n">transformed_csv_path</span><span class="si">}</span><span class="sh">'</span><span class="s">) TO </span><span class="sh">'</span><span class="si">{</span><span class="n">parquet_path</span><span class="si">}</span><span class="sh">'</span><span class="s"> (FORMAT PARQUET);
    </span><span class="sh">"""</span>
    <span class="n">con</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">copy_to_parquet_query</span><span class="p">)</span>
    <span class="n">parquet_size_bytes</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">getsize</span><span class="p">(</span><span class="n">parquet_path</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Parquet Size: </span><span class="si">{</span><span class="n">parquet_size_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> MB</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  Savings vs. Transformed CSV: </span><span class="sh">"</span>
          <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="p">((</span><span class="n">transformed_size_bytes</span> <span class="o">-</span> <span class="n">parquet_size_bytes</span><span class="p">)</span> <span class="o">/</span> <span class="n">transformed_size_bytes</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>


    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Total savings from original CSV to Parquet: </span><span class="sh">"</span>
          <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="p">((</span><span class="n">original_size_bytes</span> <span class="o">-</span> <span class="n">parquet_size_bytes</span><span class="p">)</span> <span class="o">/</span> <span class="n">original_size_bytes</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>

<span class="k">except</span> <span class="nb">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error: A required file was not found. Please ensure </span><span class="sh">'</span><span class="si">{</span><span class="n">original_csv_path</span><span class="si">}</span><span class="sh">'</span><span class="s"> and </span><span class="sh">'</span><span class="si">{</span><span class="n">transformed_csv_path</span><span class="si">}</span><span class="sh">'</span><span class="s"> exist. </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error during file compression/conversion: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">finally</span><span class="p">:</span>
    <span class="n">con</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>
<p>You should see some pretty amazing space savings.  Here are my results more than a 30% savings from the original CSV to the transformed CSV, and then over 90% savings when compressing to GZIP and converting to Parquet. More than 15X reduction, saving in the right format means you can keep a year worth of data in the space you would have used for a single month in the original CSV format.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>--- Comparing File Sizes ---
Original CSV Size: 124.82 MB
Transformed CSV Size: 85.26 MB
  Savings from Transformation (selected columns, filtered rows): 31.69%
Writing transformed data to GZIP compressed CSV: DOHMH_transformed_compressed.csv.gz
Compressed CSV (GZIP) Size: 7.56 MB
  Savings vs. Transformed CSV: 91.13%
Writing transformed data to Parquet: DOHMH_transformed.parquet
Parquet Size: 7.41 MB
  Savings vs. Transformed CSV: 91.31%

Total savings from original CSV to Parquet: 94.07%
</pre></td></tr></tbody></table></code></div></div>
<h2 id="3-data-typing--postgresql-compatibility"><span class="me-2">3. Data Typing &amp; PostgreSQL Compatibility</span><a href="#3-data-typing--postgresql-compatibility" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Before loading data into a production database like PostgreSQL, it’s crucial to confirm that your data types are correct and compatible. DuckDB does a great job of inferring types, but explicit confirmation and potential casting are good practice to avoid surprises during loading.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">duckdb</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span> <span class="c1"># For displaying schema as a DataFrame
</span>
<span class="c1"># Path to our transformed Parquet file (or CSV, it doesn't matter for schema inspection)
</span><span class="n">transformed_data_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">DOHMH_transformed.parquet</span><span class="sh">'</span>

<span class="c1"># Re-establishing connection
</span><span class="n">con</span> <span class="o">=</span> <span class="n">duckdb</span><span class="p">.</span><span class="nf">connect</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">--- Inspecting Schema for PostgreSQL Compatibility ---</span><span class="sh">"</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Use PRAGMA table_info to get the schema of data from a file
</span>    <span class="c1"># We implicitly create a temporary table/view from the file for inspection
</span>    <span class="n">schema_query</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"""</span><span class="s">
    PRAGMA table_info(</span><span class="sh">'</span><span class="si">{</span><span class="n">transformed_data_path</span><span class="si">}</span><span class="sh">'</span><span class="s">);
    </span><span class="sh">"""</span>
    <span class="n">schema_df</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="nf">sql</span><span class="p">(</span><span class="n">schema_query</span><span class="p">).</span><span class="nf">df</span><span class="p">()</span>

    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">DuckDB Inferred Schema (from transformed data):</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">schema_df</span><span class="p">.</span><span class="nf">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>

    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">--- PostgreSQL Type Considerations ---</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Here</span><span class="sh">'</span><span class="s">s a general mapping and considerations for PostgreSQL:</span><span class="sh">"</span><span class="p">)</span>

    <span class="n">pg_type_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">BIGINT</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">BIGINT</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">INTEGER</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">INTEGER</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">DOUBLE</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">DOUBLE PRECISION</span><span class="sh">'</span><span class="p">,</span> <span class="c1"># or REAL for float4
</span>        <span class="sh">'</span><span class="s">VARCHAR</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">VARCHAR(N)</span><span class="sh">'</span><span class="p">,</span>       <span class="c1"># N needs to be determined based on max length
</span>        <span class="sh">'</span><span class="s">BOOLEAN</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">BOOLEAN</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">DATE</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">DATE</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">TIMESTAMP</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">TIMESTAMP</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">BLOB</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">BYTEA</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">DECIMAL</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">NUMERIC(P, S)</span><span class="sh">'</span>     <span class="c1"># P=precision, S=scale needs to be determined
</span>    <span class="p">}</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">schema_df</span><span class="p">.</span><span class="nf">iterrows</span><span class="p">():</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span>
        <span class="n">duckdb_type</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">]</span>
        <span class="n">nullable</span> <span class="o">=</span> <span class="sh">"</span><span class="s">NULL</span><span class="sh">"</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="sh">'</span><span class="s">null</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="sh">"</span><span class="s">NOT NULL</span><span class="sh">"</span>

        <span class="n">pg_equivalent</span> <span class="o">=</span> <span class="n">pg_type_map</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">duckdb_type</span><span class="p">.</span><span class="nf">upper</span><span class="p">(),</span> <span class="sa">f</span><span class="sh">"</span><span class="s">UNKNOWN_TYPE (</span><span class="si">{</span><span class="n">duckdb_type</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span><span class="p">)</span>

        <span class="c1"># Special handling for VARCHAR to suggest length
</span>        <span class="k">if</span> <span class="n">duckdb_type</span><span class="p">.</span><span class="nf">upper</span><span class="p">()</span> <span class="o">==</span> <span class="sh">'</span><span class="s">VARCHAR</span><span class="sh">'</span><span class="p">:</span>
            <span class="c1"># To get actual max length, you'd need to query the data:
</span>            <span class="c1"># max_len_query = f"SELECT MAX(LENGTH(\"{column_name}\")) FROM '{transformed_data_path}';"
</span>            <span class="c1"># max_len = con.sql(max_len_query).fetchone()[0]
</span>            <span class="c1"># pg_equivalent = f"VARCHAR({max_len or 255})" # Use a default if max_len is 0 or None
</span>            <span class="n">pg_equivalent</span> <span class="o">=</span> <span class="sh">"</span><span class="s">VARCHAR(255)</span><span class="sh">"</span> <span class="c1"># Common default for text, adjust as needed or calculate max_len
</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">- Column: </span><span class="sh">'</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  DuckDB Type: </span><span class="si">{</span><span class="n">duckdb_type</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  PostgreSQL Equivalent: </span><span class="si">{</span><span class="n">pg_equivalent</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  Nullable: </span><span class="si">{</span><span class="n">nullable</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  Considerations: </span><span class="si">{</span><span class="sh">'</span><span class="s">Check string max length</span><span class="sh">'</span> <span class="k">if</span> <span class="n">duckdb_type</span><span class="p">.</span><span class="nf">upper</span><span class="p">()</span> <span class="o">==</span> <span class="sh">'</span><span class="s">VARCHAR</span><span class="sh">'</span> <span class="k">else</span> <span class="sh">'</span><span class="s">Confirm precision/scale</span><span class="sh">'</span> <span class="k">if</span> <span class="n">duckdb_type</span><span class="p">.</span><span class="nf">upper</span><span class="p">()</span> <span class="o">==</span> <span class="sh">'</span><span class="s">DECIMAL</span><span class="sh">'</span> <span class="k">else</span> <span class="sh">'</span><span class="s">Standard mapping</span><span class="sh">'</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">-</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>

    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">To load into PostgreSQL, you would typically use a PostgreSQL client library (like Psycopg2 in Python) or a tool like `pg_loader` after connecting to your PostgreSQL database. DuckDB acts as an intermediary here, handling the transformation and type validation.</span><span class="sh">"</span><span class="p">)</span>

<span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error: Transformed data file </span><span class="sh">'</span><span class="si">{</span><span class="n">transformed_data_path</span><span class="si">}</span><span class="sh">'</span><span class="s"> not found. Please ensure the previous steps ran successfully.</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error inspecting schema: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">finally</span><span class="p">:</span>
    <span class="n">con</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></div></div>
<h2 id="explanation-of-schema-inspection"><span class="me-2">Explanation of Schema Inspection:</span><a href="#explanation-of-schema-inspection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Let’s break down what’s happening in the schema inspection step:</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">PRAGMA table_info('file_path')</code>:</strong><br />
  This handy DuckDB command lets you peek at the schema DuckDB infers from your file—no need to create a table first. It shows you each column’s name, data type, whether it allows NULLs, and more.</p>
  </li>
  <li>
    <p><strong>Mapping to PostgreSQL:</strong><br />
  We walk through a general mapping of DuckDB types to PostgreSQL equivalents. Here are a few things to keep in mind:</p>
    <ul>
      <li><strong>VARCHAR length:</strong> DuckDB’s <code class="language-plaintext highlighter-rouge">VARCHAR</code> is flexible, but PostgreSQL usually wants a specific length (like <code class="language-plaintext highlighter-rouge">VARCHAR(255)</code>). To pick the right number, you can run a quick <code class="language-plaintext highlighter-rouge">SELECT MAX(LENGTH(column_name))</code> on your data.</li>
      <li><strong>DECIMAL / NUMERIC:</strong> If you have columns with decimal numbers (like scores), you’ll want to decide on the total number of digits (<code class="language-plaintext highlighter-rouge">PRECISION</code>) and how many come after the decimal point (<code class="language-plaintext highlighter-rouge">SCALE</code>).</li>
      <li><strong>Date/Time types:</strong> DuckDB is pretty good at figuring out dates and timestamps, but double-check if you need a plain <code class="language-plaintext highlighter-rouge">DATE</code> or a full <code class="language-plaintext highlighter-rouge">TIMESTAMP</code> (and whether you need time zones) for PostgreSQL.</li>
    </ul>
  </li>
</ul>

<hr />

<h3 id="wrapping-up-part-ii"><span class="me-2">Wrapping Up Part II</span><a href="#wrapping-up-part-ii" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>In this post, we’ve seen how DuckDB can help you:</p>

<ul>
  <li>Transform data directly from CSVs with SQL, no manual file wrangling required.</li>
  <li>Store your results in space-saving formats like compressed CSV and Parquet.</li>
  <li>Inspect and prepare your data’s schema for a smooth handoff to databases like PostgreSQL.</li>
</ul>

<p>I hope this gives you some good ideas for how t use DuckDB as an ETL tool in your data workflows.  I realize this I went in a few different directions here, I like the idea of exploring what is possible and then refining my approach for my use case.  If you have something you are using DuckDB for that I didn’t cover please share it.  I love to hearing what is working for others.</p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/data-engineering/">Data Engineering</a>,
          <a href="/categories/python/">Python</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/duckdb/"
            class="post-tag no-text-decoration"
          >DuckDB</a>
        
          <a
            href="/tags/pandas/"
            class="post-tag no-text-decoration"
          >Pandas</a>
        
          <a
            href="/tags/data-analysis/"
            class="post-tag no-text-decoration"
          >data analysis</a>
        
          <a
            href="/tags/sql/"
            class="post-tag no-text-decoration"
          >SQL</a>
        
          <a
            href="/tags/python/"
            class="post-tag no-text-decoration"
          >Python</a>
        
          <a
            href="/tags/testing/"
            class="post-tag no-text-decoration"
          >testing</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=DuckDB%20-%20Diners,%20Drives,%20and%20Databases%20Part%20II%20-%20NextValData&u=https%3A%2F%2Fnextvaldata.com%2Fdata%2520engineering%2Fpython%2F2025%2F06%2F08%2FDuckDB-Diners-Drives-and-Databases-PartII.html" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fnextvaldata.com%2Fdata%2520engineering%2Fpython%2F2025%2F06%2F08%2FDuckDB-Diners-Drives-and-Databases-PartII.html&text=DuckDB%20-%20Diners,%20Drives,%20and%20Databases%20Part%20II%20-%20NextValData" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/python/performance/apis/dataengineering/orjson/optimization/2025/07/19/Taking-the-Small-Wins.html">Taking the Small Wins: How Incremental Improvements Cut My API Call Times from 70 to 45 Minutes</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/data%20engineering/python/orchestration/2025/06/29/Better-Pipelines-with-Dagster.html">Building Data Pipelines with Dagster: Practical</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/data%20engineering/python/api/2025/06/14/Bring-me-the-Data.html">Bring me the Data</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/data%20engineering/python/2025/06/08/DuckDB-Diners-Drives-and-Databases-PartII.html">DuckDB - Diners, Drives, and Databases Part II</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/data%20engineering/python/2025/06/06/DuckDB-Diners-Drives-and-Databases.html">DuckDB - Diners, Drives, and Databases Part I</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/data-analysis/">data analysis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pandas/">Pandas</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/testing/">testing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/duckdb/">DuckDB</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/excel/">excel</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sql/">SQL</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/data%20engineering/python/2025/06/06/DuckDB-Diners-Drives-and-Databases.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1749182400"
  data-df="ll"
  
>
  Jun  6, 2025
</time>

              <h4 class="pt-0 my-2">DuckDB - Diners, Drives, and Databases Part I</h4>
              <div class="text-muted">
                <p>Hoping for an A.  Pandas has been my go-to tool for data manipulation in Python for years. So great for me, right?  End of blog post.  Except…  “If the only tool you have is a hammer, you will see ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/data%20engineering/python/api/2025/06/14/Bring-me-the-Data.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1749916800"
  data-df="ll"
  
>
  Jun 14, 2025
</time>

              <h4 class="pt-0 my-2">Bring me the Data</h4>
              <div class="text-muted">
                <p>taking it personally.  NYC Restaurant Inspections Data Pull  When I was making the DuckDB posts, I wanted to include some code to show how to pull the data from the NYC Open Data portal. In the int...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/data%20engineering/python/orchestration/2025/06/29/Better-Pipelines-with-Dagster.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1751169600"
  data-df="ll"
  
>
  Jun 29, 2025
</time>

              <h4 class="pt-0 my-2">Building Data Pipelines with Dagster: Practical</h4>
              <div class="text-muted">
                <p>I am always looking for ways to improve my data pipelines, and Dagster has been really good to me so far.  I am definitely planning on diving further into it in the future but my initial experience...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/data%20engineering/python/2025/06/06/DuckDB-Diners-Drives-and-Databases.html"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>DuckDB - Diners, Drives, and Databases Part I</p>
    </a>
  

  
    <a
      href="/data%20engineering/python/api/2025/06/14/Bring-me-the-Data.html"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Bring me the Data</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/tjadryan">Dominick Ryan</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.0"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/data-analysis/">data analysis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pandas/">Pandas</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/testing/">testing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/duckdb/">DuckDB</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/excel/">excel</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sql/">SQL</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

